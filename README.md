# Bank-Star-Recomendation

**Система рекомендаций банковских продуктов** — backend-приложение на Java (Spring Boot), которое на основе правил и данных о клиентах формирует персональные предложения продуктов (карты, кредиты, инвестиции и т.д.).

---

## Краткое описание

Проект реализует гибридную систему рекомендаций:

* Статические продукты (из основной базы `products`).
* Динамические правила рекомендаций (хранятся в отдельной базе правил). Правила используются для генерации `ProductOffer` для клиента.
* Логирование исполнения правил и статистика (эндпоинты для получения статистики по правилам).
* Интеграция с Telegram (опционально) — отправка уведомлений о рекомендациях.

В проекте также есть простые REST-эндпоинты для получения рекомендаций и управления.

---

## Технологический стек

* Java 17
* Spring Boot 3.x
* Spring Web, Spring Data / JdbcTemplate
* Maven
* PostgreSQL и H2
* Swagger / OpenAPI

---

## Быстрый старт (локально)

### Требования

* Java 17
* Maven 3+
* PostgreSQL

### Сборка

```bash
mvn clean package
```

### Запуск

* Запуск из Maven:

```bash
mvn spring-boot:run
```

* Или как jar:

```bash
java -jar target/recomendation_system-1.0-SNAPSHOT.jar
```

Приложение по умолчанию слушает на `http://localhost:8080`.

### Конфигурация

Файл конфигурации: `src/main/resources/application.properties`.

* DB: параметры `spring.datasource.*`
* Swagger: `springdoc.swagger-ui.path` -> `/swagger-ui.html`.
* Telegram: `telegram.bot.token`, `telegram.bot.username`, `telegram.bot.enabled`.

Вы можете задать переменную окружения `TELEGRAM_BOT_TOKEN` (Spring Boot автоматически подхватит `telegram.bot.token`) или передать свой токен при запуске.

## REST API (основные эндпоинты)

> Примечание: базовый путь для публичных эндпоинтов — без префикса, контроллеры используют пути, указанные в коде.

### Публичные

* `GET /api/client/{id}` — получить данные клиента (по `id`).
* `GET /api/recommendations/{id}` — получить рекомендации для клиента с `id` (внутри идёт применение правил и генерация `ProductOffer`).
* `GET /api/allProduct` — получить все доступные продукты (динамически доступные).
* `DELETE /api/{id}` — удалить правило/ресурс (см. код контроллера для точного поведения).

### Управление / метрики

* `GET /management/info` — общая информация о приложении.
* `GET /management/db-check` — проверка целостности/состояния баз (возвращает количество записей и статус).
* `POST /management/clear-caches` — очистить кэши (если включены).
* `GET /management/cache-stats` — статистика по кэшу.

### Статистика правил

* `GET /rule/stats` — общая статистика по всем правилам.
* `GET /rule/stats/{ruleId}` — статистика по конкретному правилу.
* `GET /rule/stats/user/{userId}` — статистика по правилам для пользователя.
* `POST /rule/stats/clear` — очистка логов/статистики правил.

---

## Форматы данных

Простейший DTO запроса рекомендаций:

```json
{
  "userId": "UUID клиента",
  "productIds": ["UUID продукта (опционально)"]
}
```

Модели ответов представлены в `org.courseWork.model` — основные: `Product`, `ProductOffer`.
