-- Очистка таблиц перед вставкой (опционально)
DELETE FROM product_rules;
DELETE FROM products;
DELETE FROM transactions;
DELETE FROM users;

-- Вставка тестовых продуктов
INSERT INTO products (id, product_name, description, type) VALUES
('123e4567-e89b-12d3-a456-426614174000', 'Продукт А', 'Инвестиционный портфель', 'INVESTMENT'),
('123e4567-e89b-12d3-a456-426614174001', 'Продукт Б', 'Премиальная карта', 'CARD'),
('123e4567-e89b-12d3-a456-426614174002', 'Продукт В', 'Ипотечный кредит', 'CREDIT'),
('123e4567-e89b-12d3-a456-426614174003', 'Дебетовая карта', 'Базовая дебетовая карта', 'DEBIT'),
('123e4567-e89b-12d3-a456-426614174004', 'Накопительный счет', 'Счет для накоплений', 'SAVING');

-- Вставка тестовых правил
INSERT INTO product_rules (id, product_id, rule_name, rule_description, condition_type, condition_json) VALUES
('223e4567-e89b-12d3-a456-426614174000', '123e4567-e89b-12d3-a456-426614174000', 'Для активных пользователей дебетовых карт', 'Пользователь использует DEBIT, не использует INVEST, сумма пополнений SAVING > 1000', 'CUSTOM', '{"type":"HAS_PRODUCT","productType":"DEBIT"}'),
('223e4567-e89b-12d3-a456-426614174001', '123e4567-e89b-12d3-a456-426614174001', 'Для пользователей с высокими накоплениями', 'Сумма пополнений DEBIT >= 50000 или SAVING >= 50000', 'CUSTOM', '{"type":"MIN_AMOUNT","productType":"DEBIT","minAmount":50000}'),
('223e4567-e89b-12d3-a456-426614174002', '123e4567-e89b-12d3-a456-426614174002', 'Для клиентов с крупными тратами без кредитов', 'Нет кредитов, дебетовые пополнения > трат, траты > 100000', 'CUSTOM', '{"type":"NO_PRODUCT","productType":"CREDIT"}');

-- Вставка тестовых пользователей
INSERT INTO users (id, username, first_name, last_name) VALUES
('333e4567-e89b-12d3-a456-426614174000', 'user1', 'Иван', 'Иванов'),
('333e4567-e89b-12d3-a456-426614174001', 'user2', 'Петр', 'Петров'),
('333e4567-e89b-12d3-a456-426614174002', 'user3', 'Мария', 'Сидорова');

-- Вставка тестовых транзакций
INSERT INTO transactions (id, product_id, user_id, type, amount) VALUES
-- Пользователь 1 (подходит для Продукта А)
('443e4567-e89b-12d3-a456-426614174000', '123e4567-e89b-12d3-a456-426614174003', '333e4567-e89b-12d3-a456-426614174000', 'DEPOSIT', 50000.00),
('443e4567-e89b-12d3-a456-426614174001', '123e4567-e89b-12d3-a456-426614174004', '333e4567-e89b-12d3-a456-426614174000', 'DEPOSIT', 2000.00),

-- Пользователь 2 (подходит для Продукта Б)
('443e4567-e89b-12d3-a456-426614174002', '123e4567-e89b-12d3-a456-426614174003', '333e4567-e89b-12d3-a456-426614174001', 'DEPOSIT', 60000.00),
('443e4567-e89b-12d3-a456-426614174003', '123e4567-e89b-12d3-a456-426614174003', '333e4567-e89b-12d3-a456-426614174001', 'WITHDRAWAL', 30000.00),

-- Пользователь 3 (подходит для Продукта В)
('443e4567-e89b-12d3-a456-426614174004', '123e4567-e89b-12d3-a456-426614174003', '333e4567-e89b-12d3-a456-426614174002', 'DEPOSIT', 200000.00),
('443e4567-e89b-12d3-a456-426614174005', '123e4567-e89b-12d3-a456-426614174003', '333e4567-e89b-12d3-a456-426614174002', 'WITHDRAWAL', 150000.00);